Instead of "is_M1_at_0 & is_M2_at_90" just use "M1_done & ... & M6_done" as security condition.
